<<<<<<< HEAD
# [nomoreanxious]

> [è®©è¿›å…¥é€€è¡Œæ€§å¹´é¾„çš„ç”¨æˆ·é€šè¿‡AIè¾…åŠ©çœŸæ­£æŽ¥å—ç”Ÿç†çš„å˜åŒ–å¹¶ç”¨æœ€ç§‘å­¦çš„æ–¹å¼è¿›è¡Œæ”¹å˜ï¼Œå¯¹æŠ—ç„¦è™‘ã€‚]
=======
# [nomoreanxious Â· iOS]

> è®©è¿›å…¥é€€è¡Œæ€§å¹´é¾„çš„ç”¨æˆ·é€šè¿‡ AI è¾…åŠ©çœŸæ­£æŽ¥å—ç”Ÿç†çš„å˜åŒ–ï¼Œå¹¶ç”¨æœ€ç§‘å­¦çš„æ–¹å¼è¿›è¡Œæ”¹å˜ï¼Œå¯¹æŠ—ç„¦è™‘ã€‚
>>>>>>> 2550af250fafef03545c577be9370aebeaaa9f8f

---

## 1. ðŸŽ¯ é¡¹ç›®æ„¿æ™¯ä¸Žç›®æ ‡ç”¨æˆ· (The "Why" & "Who")

<<<<<<< HEAD
* **æ ¸å¿ƒé—®é¢˜ï¼š** [ä½ è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿä¾‹å¦‚ï¼š30+ç”¨æˆ·å—åˆ°ç¤¾ä¼šåŽ‹åŠ›ï¼ŒèŒåœºåŽ‹åŠ›ï¼Œå®¶åº­åŽ‹åŠ›ï¼Œç”Ÿç†å˜åŒ–å¸¦æ¥çš„å®¹è²Œç„¦è™‘å’Œç”Ÿæ´»è´¨é‡ä¸‹é™ã€‚]
* **è§£å†³æ–¹æ¡ˆï¼š** [ä½ æ‰“ç®—å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿä¾‹å¦‚ï¼šé¦–å…ˆè®©ç”¨æˆ·æ­£è§†çœŸç›¸ï¼Œåœæ­¢è‡†æƒ³å’Œä¸æ­£ç¡®çš„æƒ…ç»ªè¾“å…¥ï¼ˆè¢«è´©å–çš„ç„¦è™‘ï¼‰ï¼Œåˆ†ç±»é—®é¢˜ï¼ˆæ¯”å¦‚ç”·æ€§çš„é›„è„±å’Œé›„æ¿€ç´ å¢žåŠ å¼•å‘çš„å…¶ä»–ç›¸å…³é—®é¢˜ï¼Œå¯ä»¥åˆ†ç±»åˆ°ä¸€èµ·ï¼‰ï¼Œè¿›è¡Œä¸ªæ€§åŒ–aiåˆ†æžï¼Œä»¥ç¬¬ä¸€æ€§åŽŸç†ä½¿ç”¨aiè¾…åŠ©æŒç»­æä¾›è§£å†³æ–¹æ¡ˆï¼ŒæŽ’é™¤å¹²æ‰°é¡¹ï¼Œè®©ä½¿ç”¨çš„ç”¨æˆ·å—åˆ°ä»£è°¢é€€è¡Œæ€§å½±å“é™è‡³æœ€å°ã€‚]
* **ç›®æ ‡ç”¨æˆ·ï¼š** [è°ä¼šä½¿ç”¨è¿™ä¸ªäº§å“ï¼Ÿä¾‹å¦‚ï¼š30-45 å²ï¼Œæœ‰ä¸€å®šæ”¶å…¥çš„é«˜çŸ¥ç²¾è‹±äººç¾¤ï¼Œä¸»è¦å®šä½åŠ å·žç¡…è°·ç§‘æŠ€åœˆï¼Œè¾å°„å…¨çƒä¸­äº§é˜¶çº§ã€‚]

## 2. âœ¨ æ ¸å¿ƒåŠŸèƒ½ä¸ŽçŠ¶æ€ (The "What")

è¿™æ˜¯ AI å·¥ä½œçš„æ ¸å¿ƒ"å¾…åŠžäº‹é¡¹åˆ—è¡¨ (To-Do List)"ã€‚

* `[âœ… å·²å®žçŽ°]` **ç”¨æˆ·ç³»ç»Ÿ** â€“ æ ¸å¿ƒè´¦å·ä½“ç³»å·²å¯ç”¨ï¼Œç»§ç»­è¡¥å……ä½“éªŒä¼˜åŒ–  
  * Web ç«¯: `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%` âœ… â€“ æ”¯æŒé‚®ç®±/å¯†ç æ³¨å†Œã€ç™»å½•ã€ç™»å‡ºã€å¿˜è®°å¯†ç ã€è¯­è¨€åˆ‡æ¢ã€èµ„æ–™ç¼–è¾‘ (`/signup`, `/login`, `/settings`)  
  * iOS ç«¯: `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%` âœ… â€“ React Native ç«¯å·²å®ŒæˆåŒç­‰æµç¨‹ï¼ˆè¯¦è§ç§»åŠ¨ç«¯ä»“åº“ï¼‰  
  * å¾…åŠžï¼šå®Œå–„å¤šè¯­è¨€ copyã€è¡¥å……å®‰å…¨å®¡è®¡ checklist

* `[ðŸš§ å¼€å‘ä¸­]` **ç¬¬ä¸‰æ–¹ç™»å½•** â€“ å½“å‰ä¸“æ³¨ web ç«¯ï¼Œæ•´ä½“è¿›åº¦ `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘] 60%`  
  * âœ… Google OAuthï¼ˆæ³¨å†Œé¡µæŒ‰é’® + Supabase provider å·²æ‰“é€šï¼‰  
  * âœ… X (Twitter) OAuthï¼ˆç™»å½•/æ³¨å†Œé¡µæŒ‰é’®ï¼Œå·²å¯è·³è½¬æŽˆæƒï¼‰  
  * âœ… GitHub OAuthï¼ˆç™»å½•é¡µæŒ‰é’®å·²è¿žé€š Supabaseï¼‰  
  * â³ web3é’±åŒ…ç™»å½•
  * â³ å¾®ä¿¡æ‰«ç ï¼ˆç›®å‰ä»…å±•ç¤ºäºŒç»´ç æç¤ºï¼Œå°šæœªæœ‰åŽç«¯å›žè°ƒï¼‰  
  * â³ iOS ç«¯ç¬¬ä¸‰æ–¹è´¦å·å°šæœªé›†æˆï¼Œéœ€ç­‰ Expo é¡¹ç›®æŽ¥å…¥

* `[ðŸš§ å¼€å‘ä¸­]` **AI åŠ©æ‰‹** â€“ è¿›åº¦ `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘] 75%`ï¼Œå¯å¯¹è¯ä½†å°šæœªå®Œæˆé¢„æµ‹åœºæ™¯  
  * âœ… Web UI (`AIAssistantChat` / `AIAssistantFloatingChat`)  
  * âœ… ä¼šè¯æŽ¥å£ `/api/ai/chat`ï¼šDeepSeek + Supabase è®°å¿†æ£€ç´¢ã€ä¸Šä¸‹æ–‡æ‹¼æŽ¥ã€å¤±è´¥é‡è¯•  
  * âœ… è®°å¿†ç³»ç»Ÿï¼š`ai_memory` è¡¨ã€å‘é‡å­˜å‚¨ã€`fetchWithRetry`ã€åŽ†å²ä¸Šä¸‹æ–‡æ³¨å…¥  
  * â³ é¢„æµ‹åž‹å»ºè®® / ä»»åŠ¡ç¼–æŽ’å°šæœªå®žçŽ°ï¼ˆéœ€è¦äº‹ä»¶è§¦å‘ + å®šæ—¶ä»»åŠ¡è”åŠ¨ï¼‰  
  * â³ iOS ç«¯å…¥å£ç­‰å¾… Expo é›†æˆ

* `[ðŸš§ å¼€å‘ä¸­]` **ä¸ªæ€§åŒ–ä¿¡æ¯æŽ¨é€** â€“ è¿›åº¦ `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 70%`  
  * âœ… Reddit & PubMed æŠ“å–ï¼š`/api/ingest-content` å·²èƒ½æ‰¹é‡å…¥åº“å¹¶ç”Ÿæˆ embedding  
  * âœ… RAG ä¾§ï¼š`match_content_feed_vectors`ã€ä½™å¼¦ç›¸ä¼¼åº¦ fallbackã€4.5+ è¿‡æ»¤ç­–ç•¥  
  * âœ… Dashboard å±•ç¤ºï¼š`<PersonalizedFeed />` + å¤‡ç”¨ trending feed  
  * â³ X.com æ•°æ®ä»ä¸ºç©ºï¼ˆ`crawlX` ä»…æ—¥å¿—æç¤ºï¼Œéœ€è¦ Twitter API æˆ–æ‰‹åŠ¨ç²¾é€‰åˆ—è¡¨ï¼‰  
  * â³ å†…å®¹è´¨é‡æ‰“åˆ† / åŽ»å™ªé€»è¾‘å¾…è½åœ°  
  * â³ iOS ç«¯ UI æœªæŽ¥å…¥

* `[ðŸš§ å¼€å‘ä¸­]` **è´å¶æ–¯ä¿¡å¿µå¾ªçŽ¯** â€“ è¿›åº¦ `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 70%`  
  * âœ… SQL: `supabase_bayesian_functions.sql`ã€`user_metrics`ã€è§¦å‘å™¨å‡½æ•°å…¨éƒ¨åˆ›å»º  
  * âœ… å›¾è¡¨ï¼š`HabitCompletionChart`, `BeliefScoreChart`ï¼ŒDashboard å·²å¯æ˜¾ç¤ºåŽ†å²æ•°æ®  
  * âœ… æ—§ç‰ˆä¹ æƒ¯æ‰“å¡ï¼ˆ`user_habits` + `habit_log`) æ”¯æŒä¿¡å¿µåˆ†æ•°å¹¶å†™å…¥æ—¥å¿—  
  * â³ Web å‰ç«¯å°šæœªè¿ç§»åˆ°æ–° `habits/habit_completions` è¡¨ï¼Œè§¦å‘å™¨æš‚æ— æ³•è¢«å®žé™…æ¿€æ´»  
  * â³ Onboarding è¿‡ç¨‹ä»ç¼ºå°‘ä¿¡å¿µé—®å· & å…ˆéªŒå€¼æ ¡å‡†  
  * â³ iOS ç«¯å›¾è¡¨å°šæœªè”è°ƒ

* `[ðŸš§ å¼€å‘ä¸­]` **æ•°æ®åŒæ­¥** â€“ è¿›åº¦ `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘] 65%`  
  * âœ… Web ç«¯åŸºç¡€ï¼šæ‰€æœ‰å…³é”®é¡µé¢ä½¿ç”¨ Supabase å®¢æˆ·ç«¯ã€Session åŒæ­¥å®Œæˆ  
  * âœ… æ–°å¢ž Realtimeï¼š`HabitList` è®¢é˜… `user_habits`/`habit_log`ï¼Œè·¨ Tab è‡ªåŠ¨åˆ·æ–°  
  * â³ ä¹ æƒ¯ä»¥å¤–çš„è¡¨ï¼ˆ`user_metrics`, `ai_memory`, `content_feed_vectors`ï¼‰ä»é è½®è¯¢  
  * â³ iOS â†” Web çš„å®žæ—¶äº’é€šæœªæ‰“é€šï¼Œéœ€è¦ Expo ç«¯è®¢é˜…åŒé¢‘é“  
  * â³ éœ€è¦åŠ ä¸Šç¦»çº¿å†²çª/é‡æ”¾ç­–ç•¥ï¼Œé˜²æ­¢åŒç«¯å¹¶å‘å†™å…¥


*(çŠ¶æ€æ ‡ç­¾: `[âœ… å·²å®žçŽ°]`, `[ðŸš§ å¼€å‘ä¸­]`, `[ðŸ’¡ è®¡åˆ’ä¸­]`, `[âŒ å·²åºŸå¼ƒ]`)*

è¡¥å……è´¦å·å’ŒæŽ¥å£ï¼š
âš ï¸ **é‡è¦ï¼šæ‰€æœ‰æ•æ„Ÿä¿¡æ¯å¿…é¡»é€šè¿‡çŽ¯å¢ƒå˜é‡é…ç½®ï¼Œä¸è¦ç¡¬ç¼–ç åœ¨ä»£ç ä¸­**

çŽ¯å¢ƒå˜é‡é…ç½®ï¼ˆéœ€è¦åœ¨ `.env.local` æ–‡ä»¶ä¸­è®¾ç½®ï¼‰ï¼š
- NEXT_PUBLIC_SUPABASE_URL - ä½ çš„ Supabase é¡¹ç›® URL
- NEXT_PUBLIC_SUPABASE_ANON_KEY - ä½ çš„ Supabase Anon Key
- DEEPSEEK_API_KEY - ä½ çš„ DeepSeek API Key
- GITHUB_CLIENT_ID - GitHub OAuth Client ID
- GITHUB_CLIENT_SECRET - GitHub OAuth Client Secret

è¡¥å……æœ¬åœ°éƒ¨ç½²åœ°å€ï¼ˆwebç«¯ï¼‰
http://localhost:3000

githubä»“åº“
https://github.com/Bronc-X/Nomoreanxiousweb.git

vercel webç«¯
project-nomoreanxious-git-main-loxxs-projects-cc4324a7.vercel.app

âš ï¸ **å®‰å…¨æç¤ºï¼š**
- æ‰€æœ‰ API Keys å’Œ Secrets å¿…é¡»é€šè¿‡çŽ¯å¢ƒå˜é‡é…ç½®
- ä¸è¦å°† `.env.local` æ–‡ä»¶æäº¤åˆ° Git
- éƒ¨ç½²æ—¶éœ€è¦åœ¨éƒ¨ç½²å¹³å°ï¼ˆVercel/Cloudflare ç­‰ï¼‰é…ç½®çŽ¯å¢ƒå˜é‡


1. ðŸš€ æž¶æž„æ€»è§ˆ (Architecture Overview)
è¿™æ˜¯ä¸€ä¸ªâ€œè§£è€¦â€çš„ã€åŽç«¯ä¼˜å…ˆçš„æž¶æž„ã€‚

ç”¨æˆ· (User) ->

[ æ„šé’ç»ˆç«¯ (Dumb Terminals) ]

iOS App (React Native + Expo)

Web App (React Native for Web + Expo)

... (é€šè¿‡ API å’Œå®žæ—¶è¿žæŽ¥) ...

[ é€»è¾‘/è®¡ç®—å±‚ (Logic Layer) ]

Vercel Serverless Functions

(èŒè´£: AI ç¼–æŽ’, RAG, å¤æ‚ API)

-> (è°ƒç”¨) -> OpenAI API

... (è¯»/å†™/è°ƒç”¨) ...

[ çŠ¶æ€å¤§è„‘ (State Brain) ]

Supabase (PostgreSQL)

(èŒè´£: è®¤è¯, æ•°æ®åº“, AI è®°å¿†, è´å¶æ–¯å‡½æ•°, è‡ªåŠ¨åŒ–ä»»åŠ¡)

2. ðŸ› ï¸ æ ¸å¿ƒç»„ä»¶æ‹†è§£ (Component Breakdown)
A. å‰ç«¯ (Dumb Terminal): React Native + Expo
æŠ€æœ¯: React Native (ä½¿ç”¨ Expo æ¡†æž¶)ã€‚

UI åº“: Tamagui (ç¡®ä¿ä½ çš„ UI åœ¨ iOS å’Œ Web ç«¯è¡¨çŽ°ä¸€è‡´ä¸”é«˜æ€§èƒ½)ã€‚

è·¯ç”±: Expo Router (ä½¿ç”¨åŸºäºŽæ–‡ä»¶çš„è·¯ç”±ï¼ŒCursor AI å¯¹æ­¤éžå¸¸ç†Ÿæ‚‰)ã€‚

èŒè´£:

è®¤è¯: ä½¿ç”¨ supabase-js SDK å¤„ç†ç”¨æˆ·ç™»å½•ã€æ³¨å†Œ (Google/X/å¾®ä¿¡ç­‰)ã€‚

è¾“å…¥: æä¾›è¡¨å•è®©ç”¨æˆ·æäº¤â€œä¹ æƒ¯æ‰“å¡â€ã€â€œæƒ…ç»ªæ—¥å¿—â€ç­‰åŽŸå§‹æ•°æ®ã€‚

å±•ç¤º: å®žæ—¶è®¢é˜… (Supabase Realtime) æˆ–æŸ¥è¯¢â€œçŠ¶æ€å¤§è„‘â€è®¡ç®—å‡ºçš„â€œçœŸç›¸â€ï¼ˆä¾‹å¦‚ï¼šâ€œè´å¶æ–¯æ›²çº¿â€å›¾è¡¨ï¼‰ã€‚

äº¤äº’: å°†ç”¨æˆ·çš„èŠå¤©æ¶ˆæ¯å‘é€åˆ°â€œé€»è¾‘å±‚â€(Vercel)ã€‚

å…³é”®è§„åˆ™: å‰ç«¯ç¦æ­¢è®¡ç®—ä»»ä½•ä¸šåŠ¡é€»è¾‘ã€‚ (ä¾‹å¦‚ï¼šå‰ç«¯ä¸åº”è¯¥çŸ¥é“â€œè´å¶æ–¯å‡½æ•°â€çš„å…¬å¼)ã€‚

B. é€»è¾‘/è®¡ç®—å±‚ (AI Agent): Vercel Functions
æŠ€æœ¯: Vercel Serverless Functions (Node.js)ã€‚

SDK: Vercel AI SDK æˆ– LangChain.js (ç”¨äºŽ AI ç¼–æŽ’)ã€‚

èŒè´£: è¿™æ˜¯ AI åŠ©æ‰‹â€œæ€è€ƒâ€çš„åœ°æ–¹ã€‚

AI å¯¹è¯ API (/api/chat):

æŽ¥æ”¶ App ä¼ æ¥çš„ç”¨æˆ·æ¶ˆæ¯ã€‚

è°ƒç”¨ Supabase pgvector æ£€ç´¢ç”¨æˆ·çš„â€œåŽ†å²è®°å¿†â€ã€‚

æž„å»ºâ€œå†·å³»â€çš„ Prompt (åŒ…å«åŽ†å²è®°å¿†)ã€‚

è°ƒç”¨ OpenAI APIã€‚

å°† Q&A å­˜å›ž pgvector (å®Œæˆè®°å¿†é—­çŽ¯)ã€‚

è¿”å›ž AI å›žåº”ã€‚

ä¸ªæ€§åŒ–ä¿¡æ¯æµ API (/api/feed):

æŽ¥æ”¶ App è¯·æ±‚ã€‚

ä»Ž Supabase pgvector èŽ·å–ç”¨æˆ·ç”»åƒã€‚

åœ¨â€œå†…å®¹æ± â€å‘é‡è¡¨ä¸­æ‰§è¡Œ RAG æœç´¢ (e.g., "ç›¸å…³æ€§ > 4.5/5")ã€‚

è¿”å›žé«˜åº¦è¿‡æ»¤çš„ä¿¡æ¯ã€‚

åŽå°ä»»åŠ¡è§¦å‘å™¨ (/api/ingest-content):

ç”± pg_cron å®šæ—¶è§¦å‘ã€‚

çˆ¬å– X/Reddit/æœŸåˆŠï¼Œå°†å…¶åµŒå…¥å¹¶å­˜å…¥â€œå†…å®¹æ± â€å‘é‡è¡¨ã€‚

C. çŠ¶æ€å¤§è„‘ (State Brain): Supabase
æŠ€æœ¯: Supabase (PostgreSQL)ã€‚

èŒè´£: å­˜å‚¨ä¸€åˆ‡â€œçœŸç›¸â€ï¼Œå¹¶æ‰§è¡Œâ€œç¬¬ä¸€æ€§åŽŸç†â€çš„è®¡ç®—ã€‚

è®¤è¯ (Auth): ç®¡ç†æ‰€æœ‰ç”¨æˆ·ï¼ˆé‚®ç®±ã€Googleã€Xã€å¾®ä¿¡ï¼‰ã€‚

AI è®°å¿† (pgvector):

è¡¨: ai_memory (user_id, embedding, content_text, created_at)ã€‚

èŒè´£: å­˜å‚¨æ¯ä¸€æ¬¡ä¸Žç”¨æˆ·çš„æœ‰æ„ä¹‰äº’åŠ¨ï¼Œå®žçŽ°â€œæ°¸ä¸SAY HIâ€ã€‚

è´å¶æ–¯é€»è¾‘ (PostgreSQL Functions):

è¿™æ˜¯ä½ çš„æ ¸å¿ƒåˆ›æ–°ç‚¹ã€‚

ä½ å°†ä½¿ç”¨ pl/pgsql (SQL çš„ä¸€ç§ç¼–ç¨‹è¯­è¨€) åœ¨æ•°æ®åº“å†…éƒ¨ç›´æŽ¥ç¼–å†™ä½ çš„â€œè´å¶æ–¯å‡½æ•°â€å’Œâ€œä¿¡å¿ƒå¢žå¼ºå‡½æ•°â€ã€‚

è§¦å‘å™¨: å½“ä¸€ä¸ªæ–°â€œä¹ æƒ¯æ‰“å¡â€è¢«å­˜å…¥ habit_completions è¡¨æ—¶ï¼Œä¸€ä¸ªæ•°æ®åº“è§¦å‘å™¨ (Trigger) ä¼šè‡ªåŠ¨è°ƒç”¨è¿™äº›å‡½æ•°ã€‚

è¾“å‡º: å‡½æ•°çš„è®¡ç®—ç»“æžœï¼ˆä¾‹å¦‚ï¼šbelief_score: 0.85ï¼‰è¢«å†™å…¥ä¸€ä¸ªâ€œçœŸç›¸è¡¨â€(e.g., user_metrics)ã€‚

å¥½å¤„: è¿™ 100% ç¬¦åˆâ€œå†·å³»â€å’Œâ€œç¬¬ä¸€æ€§åŽŸç†â€ã€‚è®¡ç®—åœ¨ç¦»æ•°æ®æœ€è¿‘çš„åœ°æ–¹å‘ç”Ÿï¼Œç»“æžœç»å¯¹å¯é ï¼Œå‰ç«¯åªæ˜¯åœ¨è¯»å–ç»“æžœã€‚

è‡ªåŠ¨åŒ– (pg_cron):

ä¸€ä¸ªå†…ç½®çš„å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨ã€‚

èŒè´£: â€œé¢„æµ‹ç”¨æˆ·è¡Œä¸ºâ€å’Œâ€œå‰çž»æ€§å»ºè®®â€ã€‚

ç¤ºä¾‹: è®¾ç½®ä¸€ä¸ª Cron ä»»åŠ¡ ('0 22 * * *') (æ¯æ™š 10 ç‚¹) è¿è¡Œä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°åˆ†æžç”¨æˆ·å½“å¤©çš„ habit_completionsï¼Œå¦‚æžœå‘çŽ°â€œæœ€å°é˜»åŠ›ä¹ æƒ¯â€æœªå®Œæˆï¼Œå®ƒå¯ä»¥ä¸»åŠ¨è°ƒç”¨ Vercel Function å‘ç”¨æˆ·æŽ¨é€ä¸€ä¸ªâ€œå†·å³»â€çš„æé†’ã€‚

3. æ ¸å¿ƒæ•°æ®æ¨¡åž‹ (Core Data Schema)
ä»¥ä¸‹æ˜¯æ”¯æŒæ­¤æž¶æž„æ‰€éœ€çš„æ ¸å¿ƒæ•°æ®è¡¨ (åœ¨ Supabase ä¸­)ï¼š

profiles (ç”¨æˆ·è¡¨):

id (å…³è” auth.users)

full_name, avatar_url, language (e.g., 'en', 'zh')

user_persona_embedding (Vector): ç”± AI ç”Ÿæˆçš„ã€æ€»ç»“ç”¨æˆ·æ ¸å¿ƒç”»åƒçš„å‘é‡ï¼ˆç”¨äºŽ RAGï¼‰ã€‚

habits (ä¹ æƒ¯å®šä¹‰è¡¨):

id, user_id, title, description (e.g., "10åˆ†é’Ÿå†¥æƒ³")

min_resistance_level (æœ€å°é˜»åŠ›ç­‰çº§ 1-5)

habit_completions (ä¹ æƒ¯æ‰“å¡è¡¨):

id, habit_id, user_id, completed_at

user_notes (å¯é€‰)

user_metrics (çœŸç›¸/æŒ‡æ ‡è¡¨):

user_id, date

belief_curve_score (float): ç”±è´å¶æ–¯å‡½æ•°è®¡ç®—å¹¶å†™å…¥

confidence_score (float): ç”±ä¿¡å¿ƒå‡½æ•°è®¡ç®—å¹¶å†™å…¥

physical_performance_score (float)

(å‰ç«¯ App åªä¼šè¯»å–è¿™å¼ è¡¨æ¥ç”»å›¾)

ai_memory (AI è®°å¿†è¡¨ - å‘é‡è¡¨):

id, user_id

content_text (Q æˆ– A çš„æ–‡æœ¬)

embedding (Vector): content_text çš„å‘é‡

created_at

content_feed_vectors (RAG å†…å®¹æ±  - å‘é‡è¡¨):

id, source_url (e.g., Reddit/X é“¾æŽ¥)

content_text (å¸–å­/è®ºæ–‡æ‘˜è¦)

embedding (Vector): content_text çš„å‘é‡

created_at

relevance_score (0-5)

published_at, crawled_at, updated_at
=======
* **æ ¸å¿ƒé—®é¢˜ï¼š** 30+ ç”¨æˆ·åœ¨äº‹ä¸š / å®¶åº­ / ç”Ÿç†å¤šé‡åŽ‹åŠ›ä¸‹äº§ç”Ÿç„¦è™‘ï¼Œéœ€è¦ä¸€ä¸ªâ€œå†·å³»ç†æ€§â€çš„åŠ©æ‰‹å¸®åŠ©ä»–ä»¬é¢å¯¹çœŸå®žçš„ç”Ÿç†ä¿¡å·ã€‚
* **è§£å†³æ–¹æ¡ˆï¼š** é€šè¿‡ iOS ç«¯è®°å½• â†’ Supabase ç®—æ³• â†’ AI åŠ©æ‰‹åé¦ˆçš„é—­çŽ¯ï¼Œæä¾›æœ€å°é˜»åŠ›ä¹ æƒ¯ã€è´å¶æ–¯ä¿¡å¿µæ›²çº¿ä»¥åŠé«˜ç½®ä¿¡åº¦çš„ä¿¡æ¯æŽ¨é€ã€‚
* **ç›®æ ‡ç”¨æˆ·ï¼š** 30-45 å²é«˜çŸ¥ç”¨æˆ·ï¼ˆç¡…è°·ç§‘æŠ€åœˆ / æµ·å¤–ä¸­äº§ï¼‰ï¼Œå¯¹å¥åº·ç®¡ç†å’Œæ•°æ®å‡†ç¡®åº¦è¦æ±‚æžé«˜ã€‚

## 2. âœ¨ iOS ç«¯æ ¸å¿ƒåŠŸèƒ½ä¸ŽçŠ¶æ€ (ä»…ç»Ÿè®¡ iOS Progress)

* `[âœ… å·²å®žçŽ°]` **ç”¨æˆ·ç³»ç»Ÿï¼ˆiOSï¼‰**  
  é‚®ç®± / å¯†ç æ³¨å†Œã€åŒè¯­ç•Œé¢ã€èµ„æ–™ç®¡ç†å‡å·²ç¨³å®šè¿è¡Œã€‚

* `[âœ… å·²å®žçŽ°]` **ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆiOSï¼‰**  
  Google / X / Reddit / å¾®ä¿¡ å·²å…¨é‡æŽ¥å…¥ Expo + Supabaseã€‚

* `[ðŸš§ å¼€å‘ä¸­]` **AI åŠ©æ‰‹ï¼ˆiOSï¼‰**  
  - æ•´ä½“è¿›åº¦ï¼š`[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50%`  
  - UIï¼š100%ï¼ˆèŠå¤©é¢æ¿ã€å†·å³»è¯­æ°”æç¤ºï¼‰  
  - å‰ç«¯ API é›†æˆï¼š100%ï¼ˆä¸Ž Vercel å‡½æ•°æ‰“é€šï¼‰  
  - åŽç«¯ç¼–æŽ’ï¼š70%ï¼ˆDeepSeek / OpenAI å›žé€€ã€é‡è¯•ã€é€ŸçŽ‡ç›‘æŽ§æœªå®Œæˆï¼‰  
  - AI è®°å¿†ç³»ç»Ÿï¼š65%ï¼ˆSQL / å‘é‡ç»“æž„å®Œæˆï¼Œéœ€åœ¨ Supabase æ‰§è¡Œè„šæœ¬ï¼‰

* `[âœ… å·²å®žçŽ°]` **ä¸ªæ€§åŒ–ä¿¡æ¯æŽ¨é€ï¼ˆiOSï¼‰**  
  App å†… `feed` tabã€`FeedItemCard`ã€`usePersonalizedFeed` Hook å·²ç»è”è°ƒ pgvector RPCï¼Œå¯æ ¹æ®ç”¨æˆ·ç”»åƒè¿”å›žç›¸å…³æ€§ > 4.5 çš„å†…å®¹ã€‚

* `[ðŸš§ å¼€å‘ä¸­]` **è´å¶æ–¯ä¿¡å¿µå¾ªçŽ¯ï¼ˆiOSï¼‰**  
  - æ•´ä½“è¿›åº¦ï¼š`[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 50%`  
  - æ•°æ®åº“å‡½æ•°ï¼š100%ï¼ˆ`supabase_bayesian_functions.sql` å·²å®Œæˆï¼‰  
  - ä¹ æƒ¯æ‰“å¡ï¼š100%ï¼ˆiOS ç«¯ UI ä¸Žè§¦å‘å™¨è”åŠ¨ï¼‰  
  - æ•°æ®å¯è§†åŒ–ï¼š100%ï¼ˆiOS ç«¯ Chart + Recharts for Expoï¼‰  
  - å½“å‰é˜»å¡žï¼šéœ€è¦åœ¨ç”Ÿäº§åº“æ‰§è¡Œ SQL è„šæœ¬ã€æŽ¥é€š `user_metrics` è¡¨çš„æ•°æ®æµã€‚

* `[ðŸš§ å¼€å‘ä¸­]` **æ•°æ®åŒæ­¥ï¼ˆiOSï¼‰**  
  - æ•´ä½“è¿›åº¦ï¼š`[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘] 75%`  
  - iOS Client å·²å¯ç”¨ Realtime ç›‘å¬ï¼›éœ€å®ŒæˆåŽå° pg_cron + Web ç«¯è®¢é˜…ä»¥ä¿è¯ç«¯åˆ°ç«¯ä¸€è‡´æ€§ã€‚

*(çŠ¶æ€æ ‡ç­¾: `[âœ… å·²å®žçŽ°]`, `[ðŸš§ å¼€å‘ä¸­]`, `[ðŸ’¡ è®¡åˆ’ä¸­]`, `[âŒ å·²åºŸå¼ƒ]`)*

---

## 3. çŽ¯å¢ƒå˜é‡ï¼ˆiOS & Supabaseï¼‰

- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`
- `DEEPSEEK_API_KEY`
- `OPENAI_API_KEY`ï¼ˆä½œä¸ºåµŒå…¥ä¸Žå¯¹è¯å…œåº•ï¼‰
- `GITHUB_CLIENT_ID / SECRET`
- `CONTENT_INGEST_API_KEY`ï¼ˆè§¦å‘ `/api/ingest-content`ï¼‰

> âš ï¸ æ‰€æœ‰å¯†é’¥å¿…é¡»å†™å…¥ `.env` / Expo configï¼Œä¸å¾—ç¡¬ç¼–ç ï¼Œä¹Ÿä¸è¦æäº¤åˆ° Gitã€‚

---

## 4. æ ¸å¿ƒæž¶æž„ (æ¦‚è§ˆ)

### A. iOS å‰ç«¯ï¼ˆExpoï¼‰
- ä½¿ç”¨ Tamagui + Expo Routerï¼Œæä¾› Dumb Terminal èƒ½åŠ›ã€‚
- è´Ÿè´£å½•å…¥ï¼šä¹ æƒ¯æ‰“å¡ / æƒ…ç»ªæ—¥å¿— / ç”Ÿç†ä¿¡å·é€Ÿè®°ã€‚
- å±•ç¤ºï¼šSupabase Realtime æŽ¨é€çš„â€œçœŸç›¸â€ï¼ˆè´å¶æ–¯æŒ‡æ ‡ã€AI æé†’ï¼‰ã€‚

### B. é€»è¾‘å±‚ï¼ˆVercel Functionsï¼‰
- `/api/ai/chat`ï¼šAI å¯¹è¯ + è®°å¿†é—­çŽ¯ï¼ˆDeepSeek â†’ OpenAI fallbackï¼‰ã€‚
- `/api/feed`ï¼šåŸºäºŽ `user_persona_embedding` ä¸Ž `content_feed_vectors` æ‰§è¡Œ RAGã€‚
- `/api/ingest-content`ï¼šCron è°ƒç”¨çš„å†…å®¹çˆ¬è™« + å‘é‡å…¥åº“ã€‚

### C. çŠ¶æ€å¤§è„‘ï¼ˆSupabaseï¼‰
- `profiles / habits / habit_completions / user_metrics`
- `ai_memory`, `content_feed_vectors`ï¼ˆpgvectorï¼‰
- `supabase_bayesian_functions.sql`, `supabase_cron_jobs.sql` è´Ÿè´£è´å¶æ–¯å¾ªçŽ¯ä¸Žæé†’ã€‚

---

## 5. å½“å‰é‡ç‚¹ TODOï¼ˆiOS ä¾§ï¼‰
1. åœ¨ Supabase Prod æ‰§è¡Œ `supabase_bayesian_functions.sql`ã€`supabase_ai_memory_vector.sql`ã€`supabase_content_feed_vectors.sql` ä»¥è§£é”çœŸå®žæ•°æ®ã€‚
2. æ‰“é€š `/api/ai/chat` çš„ AI è®°å¿†å†™å…¥ï¼Œä¿è¯ App ç«¯èŠå¤©ä¸ä¼šâ€œå¤±å¿†â€ã€‚
3. éªŒè¯ Reddit OAuth å›žè°ƒï¼ˆExpo â†’ Supabase â†’ Deep Linkï¼‰ã€‚
4. ä¸Ž Web ç«¯ç¡®è®¤æ•°æ®åŒæ­¥ç­–ç•¥ï¼Œé¿å…é‡å¤æ‰§è¡Œ Cronã€‚

>>>>>>> 2550af250fafef03545c577be9370aebeaaa9f8f
